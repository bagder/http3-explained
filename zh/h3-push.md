# HTTP/3服务器端推送

HTTP/3的服务器端推送和HTTP/2（ [RFC 7540](https://httpwg.org/specs/rfc7540.html) ）类似，但是机制略有不同。

从效果上来说，服务器端推送就是对一个不存在的客户端请求发出了响应！

只有在客户端同意的情况下，服务器端才能发起推送。在HTTP/3，客户端可以通过设置最大的流数目来限制服务器端可以推送的数量。超过这个数量时会引发连接错误。

如果服务器端认为客户端需要某信息，但是客户端还没有请求的时候，服务器端可以通过请求流发送一个 `PUSH_PROMISE` 帧，当中包含客户端可能发来的请求。然后服务器端通过一个新流发送对该请求的回复。

虽然我们已经说了服务器端要先征得客户端许可才能发送请求，客户端仍然可以在觉得合适的时候取消每一个推送。这时侯需要送一个 `CANCEL_PUSH` 帧给服务器端。

## 问题重重

自从推送这一特性在HTTP/2中讨论、开发、部署以来，它就备受争议、深受差评。为了让它有用，人们付出了无数的努力。

推送从来不是没有代价的，尽管它省了半个往返的延迟，它还是会消耗带宽。服务器端也很难从高层面知道一个资源是不是应该被推送过去。
