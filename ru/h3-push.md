# Сервер-push в HTTP/3

HTTP/3 сервер-push аналогичен тому, что описано в HTTP/2
[RFC 7540](https://httpwg.org/specs/rfc7540.html),
но использует другие механизмы.

Отправленный сервером запрос фактически является ответом на запрос,
который клиент никогда не отправлял!

Сервер-push'ы разрешены только в том случае, если клиентская сторона дала на
них согласие. В HTTP/3 клиент даже устанавливает ограничение на количество
отправлений, которые он принимает, сообщая серверу, каков максимальный идентификатор
потока отправки. Превышение этого предела приведет к ошибке соединения.

Если сервер сочтет вероятным, что клиенту нужен дополнительный ресурс, который он
не запрашивал, но все равно должен иметь, он может отправить кадр `PUSH_PROMISE`
поверх потока запроса, показывающий, как выглядит запрос, на который ответом
является push, а затем отправить этот фактический ответ по новому потоку.

Даже если предварительно было заявлено, что запросы клиента приемлемы, каждый
отдельный отправленный поток все равно может быть отменен в любое время, если
клиент сочтет это подходящим, он отправит кадр `CANCEL_PUSH` на сервер.


## Проблематичность
С тех пор как эта функция впервые была обсуждена при разработке HTTP/2, а
позже, после того, как протокол был отправлен и развернут через Интернет,
её дорабатывали бесчисленным количеством различных способов, чтобы сделать
её более полезной.

Передача данных с помощью сервер-push'а никогда не бывает «бесплатной»,
хоть она и экономит половину времени на путь туда и обратно, она все равно
использует Интернет трафик. Часто серверу трудно или даже невозможно знать
с какой степенью нужен этот ресурс клиенту.
