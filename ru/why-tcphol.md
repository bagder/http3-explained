# TCP и head-of-line блокировка
HTTP/2 сделан поверх TCP и использует гораздо меньшее количество TCP-подключений,
чем более ранние версии HTTP. TCP — это протокол для надежной передачи данных,
и вы можете в принципе думать о нем как о воображаемой цепочке между двумя устройствами.
То, что передается в сеть на одном конце, в конечном итоге попадет на другой конец в
том же порядке или соединение обрывается.

![Воображаемая TCP цепь между устройствами](../images/tcp-chain.png)

Благодаря HTTP/2 обычные браузеры делают десятки или даже сотни параллельных
передач по одному TCP-соединению.

Если один пакет будет потерян в сети где-то между двумя конечными точками,
которые используют HTTP/2, это означает, что все TCP-соединения прервутся,
до того времени как потерянный пакет успешно передастся и найдёт свой путь к
месту назначения. Поскольку TCP — это «цепочка» пакетов, что означает,
если одно звено внезапно пропадает, всё, что придёт после потерянного звена,
должно подождать.

Иллюстрация, показывающая цепь как метафору соединению в момент передачи данных
двумя потоками разных цветов.

![Вооброажаемая TCP цепь разных потоков между устройствами](../images/tcp-chain-streams.png)

Таким образом это становится head-of-line блокировкой на основе TPC.

По мере увеличения частоты потери пакетов HTTP/2 работает все менее и менее эффективно.
При потере пакетов в 2% (Что, заметьте, является ужасным качеством сети) тесты показали,
что HTTP/1 обычно лучше справляется с этим, потому что у него обычно есть до шести TCP-соединений
для распределения потерянных пакетов. Это означает, что для каждого потерянного
пакета другие соединения все еще могут продолжать функционировать.

Устранить эту проблему с использованием TCP непросто, если это вообще возможно.


## Независимость потоков
С QUIC по-прежнему надо настраивать соединение между двумя конечными точками,
которое делает его безопасным и доставку данных надежной.

![Воображаемый поток QUIC между двумя устройствами](../images/tcp-chain.png)

При настройке двух разных потоков по соединению они обрабатываются независимо,
так что, если какое-либо звено пропадёт для одного из потоков, только этот поток и
эта конкретная цепочка, должны приостановиться и ждать повторной передачи недостающего пакета.

Иллюстрация, показывающая два независимых потока данных разными цветами, посылаемые
между двумя устройствами.

![Воображаемые потоки QUIC между двумя устройствами](../images/quic-chain-streams.png)
